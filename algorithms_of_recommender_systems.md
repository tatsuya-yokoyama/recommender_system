# Algorithms of Recommender Systems
このノートは、神嶌先生による解説記事[「推薦システムのアルゴリズム」](http://www.kamishima.net/archive/recsysdoc.pdf)を見ながら、自分なりに推薦システムについてまとめたものです。基本的にこの解説記事にのっている内容をまとめていますが、一部そうでないものもありますのでご了承ください。


# 構成
- 第Ⅰ部
  - 推薦システムとは何か
  - 設計指針や分類
- 第Ⅱ部
  - 推薦システムの実行過程
    - データの入力
    - 嗜好の予測
    - 推薦の掲示
- 第Ⅲ部
  - さまざまな嗜好の予測アルゴリズム
- 第Ⅳ部
  - 推薦システムに関連する話題
  - さまざまな状況での推薦
- 第Ⅴ部
  - 関連資料の紹介
  - まとめ


# 第1章 推薦システム


## 推薦システムとは？

### ACM Communications 誌での特集
自分の経験だけでは違いがあまりよくわからないものの中からでも，どうしてもどれか を選ばなければならないということはよくある．こうしたときには，口コミ，推薦状， 新聞の書評や映画評，ザガットのレストランガイドなどの他人からの推薦に頼ることを 日常的に行っている． 推薦システムは，こうした社会で普通に行われている一連の行為を補助したり，促進し たりする．

### Konstan
推薦システム：どれに価値があるかを特定するのを助ける道具


## なんで推薦システム？

大きな背景２つ

1. 大量の情報が発信されるようになった
2. 大量の情報を受信できるようになった

その結果、情報がありすぎて、欲しい情報にたどりつくことが困難(=情報過多)という問題が発生。
この問題に対処するために、利用者が欲しい情報を見つけ出すのが推薦システム


## 推薦システムの歴史
- 1992年 
  - 協調フィルタリングの提案
  - 他人が手動で行った推薦を検索するシステムにすぎなかった
- 1994年
  - ↑を自動化したGroupLensが提案され、現在の推薦システムの基礎となる
  - 内容ベースフィルタリングを推薦システムに使う研究がさかんになり始めた
- 1997年
  - recommender systemという呼び名の定着
  - システムの商業化がはじまった
- 2000年以降
  - ECサイトの発展に伴い、推薦システムの重要性が広く認識され始める


## 推薦システムに必要な３つの技術
1. 人間から必要な情報を収集するインターフェース
2. 収集したデータを使う、機械学習、統計的予測
3. 推薦に必要な情報をためるデータベース、並列計算、ネットワーク

※ この資料では、１つ目と２つ目を中心に紹介する



# 第2章 推薦システムの分類と目的
## 2.1 推薦の個人化の度合い

### 非個人化
誰にでも同じ推薦をする　
- iTunes Storeでの例
    - ニューリリース
    - トップソング、トップアルバム
    - 限定
    - 新作シングル
- Amazonでの例
    - おもちゃの売れ筋ランキング
    - ドラッグストアの売れ筋ランキング
- はてぶの人気エントリー

### 一時的個人化
短い時間で同じような振る舞いをした利用者には、同じ推薦をする
- Amazonでの例
    - あわせて買いたい
    - 商品の詳細
    - カスタマーレビュー
- GoogleアプリでWebページ閲覧中の「他の人はこちらもチェック」

### 永続的個人化
利用者の個人情報(性別、年齢など)や履歴にもとづいて推薦する
- Amazonでの例
    - 閲覧履歴に基づくおすすめ商品
    - ほしいものリストにある商品に基づくおすすめ商品
- Googleアプリでのフィード

## 2.2 推薦システムの運用目的と分類
Ben Schaferらは推薦システムを運用側の目的に応じて下記の5種類に分類し、目的に応じて適切に組み合わせて利用すべきと述べている
### 概要推薦

- サービスの統計情報を用いた推薦
- 今週の売上げランキングや、評論家が推薦する書籍、特売品などが例
- 利用者の要求との関連性を見出して、システムの利用を続けてもらえる大まかな情報を提供することが目的
- 非個人化、もしくは一時的個人化が適切
- はてぶの人気エントリー

### 利用者評価

- 利用者による推薦(口コミ、評価レート、レビュー)
- 運用側のシステムは客観性が疑われるのに対して、利用者評価は信用され、推薦を受け入れやすい
- 評価順にした非個人化や、閲覧中のアイテムの評価やレビューなどの一時的個人化
- ECサイト、グルメサイトでよくあるやつ

### 通知サービス

- メールやPush通知などで、利用者に商品を推薦
- 利用者の過去の購買履歴に基づく永続的個人化
- 利用者が予め設定した条件(自分が好きなアーティスト)に基づく、一時的個人化
- サービスの継続率向上も目的となる
- SUUMOでのご希望の条件で更新物件がありますメール

### 関連アイテム推薦

- ECサイトで利用者が閲覧している、カートにいれている商品に類似する商品(比較)を推薦して、購入の判断を助けたり、購入の決断を促す
- 補足的な商品を推薦して、同時購入を促す
- 注目している商品だけにもとづく一時的個人化に限らず、過去の行動を考慮した永続的個人化どちらもある
- GoogleアプリでWebページ閲覧中の「他の人はこちらもチェック」

### 緊密な個人化

- 利用者の情報や、行動履歴をもとにした推薦
- 行動履歴を蓄積することで永続的な個人化が可能
- 他のシステムとの差別化に繋がり、利用者との長期間にわたるロイヤリティ構築に役立つ
- 最も実装が困難で、コストも要する
- Googleアプリのフィード


## 2.3 推薦システムの予測タスクの分類

Herlockerらによる、推薦システムが達成するタスクの分類を示す

### 適合アイテム発見
- 利用者の好みに合ったものを見つけ出すこと
- 利用者が、よし今からXXをXXするのに適したXXを探すぞ−！ってなときに使われる
- 例：Rettyで渋谷の厳選ランチ10選を見ながら、今日のお店を決める

### 評価値予測
- 利用者がアイテムにつけるであろう評価値を予測すること
- 意思決定をするような動機まではない
- 例：食べログで、渋谷でおいしい焼肉を点数を見ながら探す(点数=アイテムにつけるであろう評価値)

### 適合アイテム列挙
- 自分がほしい情報を網羅的に見つけ出すこと
- すなわち、ほしくない情報を除外すること(=ほぼ検索)
- 例としては、メールを見るときに、スパムメールを除外するなど
- 例：SUUMOで、家賃XX以下、XX駅から徒歩10分以内、、、などを満たす物件一覧を検索

### 効用最適化
- 何らかの効用関数を設定し、それを最適化するアイテムを見つけること
- 適合アイテム発見を一般化したシステム
- 例：AppleでMacBookProを買ったら、USB Type-Cの変換アダプタを一緒に買うようにおすすめされた


## 2.4 推薦システムの利用動機の分類

Swearingenらは、利用者の推薦システムの利用動機の分類を示した。上の方ほど正解率を重視、下の方ほど多様性を重視。Webページの推薦の場合、その人が今どういう使用状況なのかや、今見ているページのニッチ度に応じて適切なものを使うのがよさそう。

### 備忘録
- 知っているアイテムを思い出させる
- 一度開いたがちゃんと読んでいなかったり、あとで読むに登録しているWebページなど

### 類似品
- 比較などのために、知っているアイテムに類似したものを探す

### 新規アイテム
- 自分が確実に好むであろう、まだ知らない新製品を探す

### 視野を広げる
- 他のジャンルにも自分の関心を広げる




# 第3章 推薦システム設計の要素

推薦システムのためにはたくさんのアルゴリズムがある。どれを使えばよいか？ノーフリーランチ定理により万能なアルゴリズムは存在しない。推薦システムを利用する目的や、推薦を実行する環境の制約に応じて選択する必要がある。考慮すべき大きな要因は次の2つ。

- 推薦の性質
    - 利用者の目的に適切な推薦の性質を備えるべき
- 推薦を計算するためのデータや計算資源の制約
    - データや計算資源は無限にはないので、何らかのトレードオフを考慮して推薦システムは設計すべき



## 3.1 推薦の性質
推薦システムでは利用者が好きそうなものを予測して推薦する。しかし、利用者が何を好むかは、目的、状況、推薦の候補などによって変化する。推薦の性質を決めるにあたって考慮すべき基準があると役に立つ。その基準を示す

### 3.1.1 予測精度
利用者が、推薦したアイテムにどれくらい関心を持つかという基準。最も重視すべき基準。
ハイパーパラメーターがある時は、データを訓練用、確認用、テスト用の3つに分ける必要がある。
推薦システムでは次のような尺度が、テスト用データに対する予測精度の評価に利用されている。


#### 正解率(accuracy)
推薦したもののうち、適合したものの割合。

#### 精度、適合率(precision)と再現率(recall)
適合であると推薦したもののうち、実際に適合しているものの割合が精度。実際に適合しているもののうち、適合だと推薦したものの割合が再現率(正解の内、どれくらい予測できたか)。この辺は、グノシーデータ分析ブログの[いまさら聞けない機械学習の評価関数](https://data.gunosy.io/entry/2016/08/05/115345)がわかりやすい。

#### 平均絶対誤差
TODO

#### half-life utility metric と順位相関 (rank correlation)
TODO

### 3.1.2 多様性・セレンディピティ
利用者が関心があることに加えて、目新しさやセレンディピティがが満たされるとさらによい。利用者がスピルバーグ監督のファンだった場合を例にして説明する。
#### 目新しさ
- わかりきったものでないこと、まだ知らないこと
- スピルバーグ監督の新作映画を推薦する
#### セレンディピティ
- 目新しさに意外性が加わったもの
- スピルバーグ監督とよく似た作風の新人監督の作品

一般に、推薦がはずれたときにあまりリスクがないが、推薦があたったときに満足度が大きい分野では、セレンディピティを重視すべきである。映画や音楽など娯楽に関する推薦では、こうした状況になることが多い。セレンディピティに伴う感情を定量的に評価する試みの一つとして多様性が挙げられる。

#### 多様性
- 推薦リストに含まれるアイテムが互いに似ていないこと



